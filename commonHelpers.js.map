{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getPictures(keywordForSearch, currentPage, perPage) {\n  const BASE_URL = 'https://pixabay.com/';\n  const END_POINT = 'api/';\n  const searchParams = new URLSearchParams({\n    key: '43016560-45bd583880e427992fd0250d3',\n    q: keywordForSearch,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: perPage,\n  });\n  const url = `${BASE_URL}${END_POINT}?${searchParams}`;\n  const response = await axios.get(url);\n  return response.data;\n}\n\n// One more example how we can create the same in another way with Axios\n/*const axiosInstance = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n  headers: { api_key: '43016560-45bd583880e427992fd0250d3' },\n  params: {\n    q: keywordForSearch,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  },\n});\n\nexport async function getPictures2(keywordForSearch) {\n  const response = await axiosInstance.get('', { params, headers });\n  return response.data;\n}\n*/\n","// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n// import { lightBox } from '../main';\n\nexport function pictureMarkup(arr) {\n  if (arr.length === 0) {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topRight',\n      theme: 'dark',\n    });\n    return '';\n  } else {\n    const markup = arr\n      .map(\n        arr =>\n          `<li class=\"pictures-list-item\">\n        <a class=\"picture-link\" href=\"${arr.largeImageURL}\">\n        <img src=\"${arr.webformatURL}\" alt=\"${arr.tags}\" class=\"picture\" />\n        </a>\n        <ul class=\"picture-data-list\">\n          <li class=\"picture-data-item\"><p class=\"picture-inf\">Likes</p><p class = \"picture-inf-data\">${arr.likes}</p></li>\n          <li class=\"picture-data-item\"><p class=\"picture-inf\">Views</p><p class = \"picture-inf-data\">${arr.views}</p></li>\n          <li class=\"picture-data-item\"><p class=\"picture-inf\">Comments</p><p class = \"picture-inf-data\">${arr.comments}</p></li>\n          <li class=\"picture-data-item\"><p class=\"picture-inf\">Downloads</p><p class = \"picture-inf-data\">${arr.downloads}</p></li>\n        </ul>\n      </li>`\n      )\n      .join('');\n    return markup;\n  }\n}\n","import { getPictures } from './js/pixabay-api';\nimport { pictureMarkup } from './js/render-functions';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.search-photo');\nconst picturesList = document.querySelector('.pictures-list');\nconst loader = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more-button');\nexport const lightBox = new SimpleLightbox('.pictures-list a', {\n  /* options */\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nlet query = '';\nlet currentPage = 1;\nlet maxPage = 0;\nconst perPage = 15;\n\nform.addEventListener('submit', handleSubmitSearch);\nloadMoreButton.addEventListener('click', handleLoadMore);\n\nasync function handleSubmitSearch(event) {\n  event.preventDefault();\n  picturesList.innerHTML = '';\n  // Button will be hide after successful query,\n  //if user will attempt to complete the request whith empty query\n  hideLoadMoreButton();\n  currentPage = 1;\n\n  query = form.search.value.toLowerCase().trim();\n  if (query != '') {\n    try {\n      showLoader();\n      const photos = await getPictures(query, currentPage, perPage);\n      const arrPhotos = photos.hits;\n      maxPage = Math.ceil(photos.totalHits / perPage);\n      // console.log(maxPage);\n      picturesList.insertAdjacentHTML('beforeend', pictureMarkup(arrPhotos));\n      lightBox.refresh();\n    } catch (error) {\n      console.log(error);\n    }\n    hideLoader();\n    if (maxPage !== 0) checkBtnStatus();\n    form.reset();\n  } else {\n    maxPage = 0;\n    // checkBtnStatus();\n    iziToast.error({\n      message: 'Please enter valid query.',\n      position: 'topRight',\n      theme: 'dark',\n    });\n  }\n}\n\nasync function handleLoadMore(event) {\n  ++currentPage;\n  try {\n    showLoader();\n    const photos = await getPictures(query, currentPage, perPage);\n    const arrPhotos = photos.hits;\n    picturesList.insertAdjacentHTML('beforeend', pictureMarkup(arrPhotos));\n    lightBox.refresh();\n  } catch (error) {\n    console.log(error);\n  }\n  scrollDown();\n  hideLoader();\n  checkBtnStatus();\n}\n\nfunction showLoader() {\n  loader.style.display = 'inline-block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction showLoadMoreButton() {\n  loadMoreButton.classList.remove('hidden');\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreButton.classList.add('hidden');\n}\n\nexport function checkBtnStatus() {\n  if (currentPage >= maxPage) {\n    hideLoadMoreButton();\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    showLoadMoreButton();\n  }\n}\n\nfunction scrollDown() {\n  const height = picturesList.firstChild.getBoundingClientRect().height;\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["getPictures","keywordForSearch","currentPage","perPage","BASE_URL","END_POINT","searchParams","url","axios","pictureMarkup","arr","iziToast","form","picturesList","loader","loadMoreButton","lightBox","SimpleLightbox","query","maxPage","handleSubmitSearch","handleLoadMore","event","hideLoadMoreButton","showLoader","photos","arrPhotos","error","hideLoader","checkBtnStatus","scrollDown","showLoadMoreButton","height"],"mappings":"owBAEO,eAAeA,EAAYC,EAAkBC,EAAaC,EAAS,CACxE,MAAMC,EAAW,uBACXC,EAAY,OACZC,EAAe,IAAI,gBAAgB,CACvC,IAAK,qCACL,EAAGL,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAUC,CACd,CAAG,EACKI,EAAM,GAAGH,CAAQ,GAAGC,CAAS,IAAIC,CAAY,GAEnD,OADiB,MAAME,EAAM,IAAID,CAAG,GACpB,IAClB,CCXO,SAASE,EAAcC,EAAK,CACjC,OAAIA,EAAI,SAAW,GACjBC,EAAS,MAAM,CACb,QACE,2EACF,SAAU,WACV,MAAO,MACb,CAAK,EACM,IAEQD,EACZ,IACCA,GACE;AAAA,wCAC8BA,EAAI,aAAa;AAAA,oBACrCA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA;AAAA,wGAGkDA,EAAI,KAAK;AAAA,wGACTA,EAAI,KAAK;AAAA,2GACNA,EAAI,QAAQ;AAAA,4GACXA,EAAI,SAAS;AAAA;AAAA,YAGlH,EACA,KAAK,EAAE,CAGd,CC1BA,MAAME,EAAO,SAAS,cAAc,eAAe,EAC7CC,EAAe,SAAS,cAAc,gBAAgB,EACtDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAAc,mBAAmB,EACpDC,EAAW,IAAIC,EAAe,mBAAoB,CAE7D,aAAc,MACd,aAAc,GAChB,CAAC,EACD,IAAIC,EAAQ,GACRhB,EAAc,EACdiB,EAAU,EACd,MAAMhB,EAAU,GAEhBS,EAAK,iBAAiB,SAAUQ,CAAkB,EAClDL,EAAe,iBAAiB,QAASM,CAAc,EAEvD,eAAeD,EAAmBE,EAAO,CASvC,GARAA,EAAM,eAAc,EACpBT,EAAa,UAAY,GAGzBU,IACArB,EAAc,EAEdgB,EAAQN,EAAK,OAAO,MAAM,YAAW,EAAG,OACpCM,GAAS,GAAI,CACf,GAAI,CACFM,IACA,MAAMC,EAAS,MAAMzB,EAAYkB,EAAOhB,EAAaC,CAAO,EACtDuB,EAAYD,EAAO,KACzBN,EAAU,KAAK,KAAKM,EAAO,UAAYtB,CAAO,EAE9CU,EAAa,mBAAmB,YAAaJ,EAAciB,CAAS,CAAC,EACrEV,EAAS,QAAO,CACjB,OAAQW,EAAO,CACd,QAAQ,IAAIA,CAAK,CAClB,CACDC,IACIT,IAAY,GAAGU,IACnBjB,EAAK,MAAK,CACd,MACIO,EAAU,EAEVR,EAAS,MAAM,CACb,QAAS,4BACT,SAAU,WACV,MAAO,MACb,CAAK,CAEL,CAEA,eAAeU,EAAeC,EAAO,CACnC,EAAEpB,EACF,GAAI,CACFsB,IAEA,MAAME,GADS,MAAM1B,EAAYkB,EAAOhB,EAAaC,CAAO,GACnC,KACzBU,EAAa,mBAAmB,YAAaJ,EAAciB,CAAS,CAAC,EACrEV,EAAS,QAAO,CACjB,OAAQW,EAAO,CACd,QAAQ,IAAIA,CAAK,CAClB,CACDG,IACAF,IACAC,GACF,CAEA,SAASL,GAAa,CACpBV,EAAO,MAAM,QAAU,cACzB,CAEA,SAASc,GAAa,CACpBd,EAAO,MAAM,QAAU,MACzB,CAEA,SAASiB,GAAqB,CAC5BhB,EAAe,UAAU,OAAO,QAAQ,CAC1C,CAEA,SAASQ,GAAqB,CAC5BR,EAAe,UAAU,IAAI,QAAQ,CACvC,CAEO,SAASc,GAAiB,CAC3B3B,GAAeiB,GACjBI,IACAZ,EAAS,KAAK,CACZ,QAAS,4DACf,CAAK,GAEDoB,GAEJ,CAEA,SAASD,GAAa,CACpB,MAAME,EAASnB,EAAa,WAAW,sBAAqB,EAAG,OAC/D,OAAO,SAAS,CACd,IAAKmB,EAAS,EACd,SAAU,QACd,CAAG,CACH"}